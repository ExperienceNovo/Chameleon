!function t(r,o,n){function i(a,u){if(!o[a]){if(!r[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(e)return e(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var c=o[a]={exports:{}};r[a][0].call(c.exports,function(t){var o=r[a][1][t];return i(o?o:t)},c,c.exports,t,r,o,n)}return o[a].exports}for(var e="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(t,r,o){var n,i,e=function(t,r){function o(){this.constructor=t}for(var n in r)a.call(r,n)&&(t[n]=r[n]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t},a={}.hasOwnProperty;i=t("./image"),r.exports=n=function(t){function r(t,r){this.img=document.createElement("img"),this.img.src=t,this.img.onload=function(t){return function(){return t._initCanvas(),"function"==typeof r?r(null,t):void 0}}(this),this.img.onerror=function(o){return function(o){var n;return n=new Error("Fail to load image: "+t),n.raw=o,"function"==typeof r?r(n):void 0}}(this)}return e(r,t),r.prototype._initCanvas=function(){return this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=this.img.width,this.height=this.canvas.height=this.img.height,this.context.drawImage(this.img,0,0,this.width,this.height),console.log(this.width,this.height)},r.prototype.clear=function(){return this.context.clearRect(0,0,this.width,this.height)},r.prototype.update=function(t){return this.context.putImageData(t,0,0)},r.prototype.getPixelCount=function(){return this.width*this.height},r.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},r.prototype.removeCanvas=function(){return this.canvas.parentNode.removeChild(this.canvas)},r}(i)},{"./image":4}],2:[function(t,r,o){var n;n=t("./vibrant"),n.Image=t("./browser-image"),r.exports=n},{"./browser-image":1,"./vibrant":7}],3:[function(t,r,o){var n;window.Vibrant=n=t("../")},{"../":2}],4:[function(t,r,o){var n;r.exports=n=function(){function t(){}return t.prototype.clear=function(){},t.prototype.update=function(t){},t.prototype.getPixelCount=function(){},t.prototype.getImageData=function(){},t.prototype.removeCanvas=function(){},t}()},{}],5:[function(t,r,o){var n,i;i=t("./util"),r.exports=n=function(){function t(t,r){this.rgb=t,this.population=r}return t.prototype.hsl=void 0,t.prototype.rgb=void 0,t.prototype.population=1,t.yiq=0,t.prototype.getHsl=function(){return this.hsl?this.hsl:this.hsl=i.rgbToHsl(this.rgb[0],this.rgb[1],this.rgb[2])},t.prototype.getPopulation=function(){return this.population},t.prototype.getRgb=function(){return this.rgb},t.prototype.getHex=function(){return"#"+((1<<24)+(this.rgb[0]<<16)+(this.rgb[1]<<8)+this.rgb[2]).toString(16).slice(1,7)},t.prototype.getTitleTextColor=function(){return this._ensureTextColors(),this.yiq<200?"#fff":"#000"},t.prototype.getBodyTextColor=function(){return this._ensureTextColors(),this.yiq<150?"#fff":"#000"},t.prototype._ensureTextColors=function(){return this.yiq?void 0:this.yiq=(299*this.rgb[0]+587*this.rgb[1]+114*this.rgb[2])/1e3},t}()},{"./util":6}],6:[function(t,r,o){r.exports={defaults:function(){var t,r,o,n,i,e;for(i={},r=0,n=arguments.length;n>r;r++){t=arguments[r];for(o in t)e=t[o],null==i[o]&&(i[o]=e)}return i},rgbToHsl:function(t,r,o){var n,i,e,a,u,s;if(t/=255,r/=255,o/=255,a=Math.max(t,r,o),u=Math.min(t,r,o),i=void 0,s=void 0,e=(a+u)/2,a===u)i=s=0;else{switch(n=a-u,s=e>.5?n/(2-a-u):n/(a+u),a){case t:i=(r-o)/n+(o>r?6:0);break;case r:i=(o-t)/n+2;break;case o:i=(t-r)/n+4}i/=6}return[i,s,e]},hslToRgb:function(t,r,o){var n,i,e,a,u,s;return s=void 0,i=void 0,n=void 0,e=function(t,r,o){return 0>o&&(o+=1),o>1&&(o-=1),1/6>o?t+6*(r-t)*o:.5>o?r:2/3>o?t+(r-t)*(2/3-o)*6:t},0===r?s=i=n=o:(u=.5>o?o*(1+r):o+r-o*r,a=2*o-u,s=e(a,u,t+1/3),i=e(a,u,t),n=e(a,u,t-1/3)),[255*s,255*i,255*n]}}},{}],7:[function(t,r,o){var n,i,e,a=function(t,r){return function(){return t.apply(r,arguments)}},u=[].slice;n=t("./swatch"),e=t("./util"),r.exports=i=function(){function r(t,r){this.sourceImage=t,null==r&&(r={}),this.swatches=a(this.swatches,this),this.opts=e.defaults(r,{colorCount:64,quality:5})}return r.prototype.quantize=t("quantize"),r.prototype._swatches=[],r.prototype.TARGET_DARK_LUMA=.26,r.prototype.MAX_DARK_LUMA=.45,r.prototype.MIN_LIGHT_LUMA=.55,r.prototype.TARGET_LIGHT_LUMA=.74,r.prototype.MIN_NORMAL_LUMA=.3,r.prototype.TARGET_NORMAL_LUMA=.5,r.prototype.MAX_NORMAL_LUMA=.7,r.prototype.TARGET_MUTED_SATURATION=.3,r.prototype.MAX_MUTED_SATURATION=.4,r.prototype.TARGET_VIBRANT_SATURATION=1,r.prototype.MIN_VIBRANT_SATURATION=.35,r.prototype.WEIGHT_SATURATION=3,r.prototype.WEIGHT_LUMA=6,r.prototype.WEIGHT_POPULATION=1,r.prototype.VibrantSwatch=void 0,r.prototype.MutedSwatch=void 0,r.prototype.DarkVibrantSwatch=void 0,r.prototype.DarkMutedSwatch=void 0,r.prototype.LightVibrantSwatch=void 0,r.prototype.LightMutedSwatch=void 0,r.prototype.HighestPopulation=0,r.prototype.getSwatches=function(t){var r;return r=new this.constructor.Image(this.sourceImage,function(r){return function(o,n){var i;if(null!=o)return t(o);try{return r._process(n,r.opts),t(null,r.swatches())}catch(e){return i=e,t(i)}}}(this))},r.prototype._process=function(t,r){var o,i,e,a,u,s,h,c,p,f,l;for(h=t.getImageData(),f=h.data,p=t.getPixelCount(),i=[],s=0;p>s;)c=4*s,l=f[c+0],u=f[c+1],e=f[c+2],o=f[c+3],o>=125&&(l>250&&u>250&&e>250||i.push([l,u,e])),s+=r.quality;return a=this.quantize(i,r.colorCount),this._swatches=a.vboxes.map(function(t){return function(t){return new n(t.color,t.vbox.count())}}(this)),this.maxPopulation=this.findMaxPopulation,this.generateVarationColors(),this.generateEmptySwatches(),t.removeCanvas()},r.prototype.generateVarationColors=function(){return this.VibrantSwatch=this.findColorVariation(this.TARGET_NORMAL_LUMA,this.MIN_NORMAL_LUMA,this.MAX_NORMAL_LUMA,this.TARGET_VIBRANT_SATURATION,this.MIN_VIBRANT_SATURATION,1),this.LightVibrantSwatch=this.findColorVariation(this.TARGET_LIGHT_LUMA,this.MIN_LIGHT_LUMA,1,this.TARGET_VIBRANT_SATURATION,this.MIN_VIBRANT_SATURATION,1),this.DarkVibrantSwatch=this.findColorVariation(this.TARGET_DARK_LUMA,0,this.MAX_DARK_LUMA,this.TARGET_VIBRANT_SATURATION,this.MIN_VIBRANT_SATURATION,1),this.MutedSwatch=this.findColorVariation(this.TARGET_NORMAL_LUMA,this.MIN_NORMAL_LUMA,this.MAX_NORMAL_LUMA,this.TARGET_MUTED_SATURATION,0,this.MAX_MUTED_SATURATION),this.LightMutedSwatch=this.findColorVariation(this.TARGET_LIGHT_LUMA,this.MIN_LIGHT_LUMA,1,this.TARGET_MUTED_SATURATION,0,this.MAX_MUTED_SATURATION),this.DarkMutedSwatch=this.findColorVariation(this.TARGET_DARK_LUMA,0,this.MAX_DARK_LUMA,this.TARGET_MUTED_SATURATION,0,this.MAX_MUTED_SATURATION)},r.prototype.generateEmptySwatches=function(){var t;return void 0===this.VibrantSwatch&&void 0!==this.DarkVibrantSwatch&&(t=this.DarkVibrantSwatch.getHsl(),t[2]=this.TARGET_NORMAL_LUMA,this.VibrantSwatch=new n(e.hslToRgb(t[0],t[1],t[2]),0)),void 0===this.DarkVibrantSwatch&&void 0!==this.VibrantSwatch?(t=this.VibrantSwatch.getHsl(),t[2]=this.TARGET_DARK_LUMA,this.DarkVibrantSwatch=new n(e.hslToRgb(t[0],t[1],t[2]),0)):void 0},r.prototype.findMaxPopulation=function(){var t,r,o,n,i;for(o=0,n=this._swatches,t=0,r=n.length;r>t;t++)i=n[t],o=Math.max(o,i.getPopulation());return o},r.prototype.findColorVariation=function(t,r,o,n,i,e){var a,u,s,h,c,p,f,l,g;for(h=void 0,c=0,p=this._swatches,a=0,u=p.length;u>a;a++)l=p[a],f=l.getHsl()[1],s=l.getHsl()[2],f>=i&&e>=f&&s>=r&&o>=s&&!this.isAlreadySelected(l)&&(g=this.createComparisonValue(f,n,s,t,l.getPopulation(),this.HighestPopulation),(void 0===h||g>c)&&(h=l,c=g));return h},r.prototype.createComparisonValue=function(t,r,o,n,i,e){return this.weightedMean(this.invertDiff(t,r),this.WEIGHT_SATURATION,this.invertDiff(o,n),this.WEIGHT_LUMA,i/e,this.WEIGHT_POPULATION)},r.prototype.invertDiff=function(t,r){return 1-Math.abs(t-r)},r.prototype.weightedMean=function(){var t,r,o,n,i,e;for(i=1<=arguments.length?u.call(arguments,0):[],r=0,o=0,t=0;t<i.length;)n=i[t],e=i[t+1],r+=n*e,o+=e,t+=2;return r/o},r.prototype.swatches=function(){return{Vibrant:this.VibrantSwatch,Muted:this.MutedSwatch,DarkVibrant:this.DarkVibrantSwatch,DarkMuted:this.DarkMutedSwatch,LightVibrant:this.LightVibrantSwatch,LightMuted:this.LightMuted}},r.prototype.isAlreadySelected=function(t){return this.VibrantSwatch===t||this.DarkVibrantSwatch===t||this.LightVibrantSwatch===t||this.MutedSwatch===t||this.DarkMutedSwatch===t||this.LightMutedSwatch===t},r}()},{"./swatch":5,"./util":6,quantize:8}],8:[function(t,r,o){if(!n)var n={map:function(t,r){var o={};return r?t.map(function(t,n){return o.index=n,r.call(o,t)}):t.slice()},naturalOrder:function(t,r){return r>t?-1:t>r?1:0},sum:function(t,r){var o={};return t.reduce(r?function(t,n,i){return o.index=i,t+r.call(o,n)}:function(t,r){return t+r},0)},max:function(t,r){return Math.max.apply(null,r?n.map(t,r):t)}};var i=function(){function t(t,r,o){return(t<<2*h)+(r<<h)+o}function r(t){function r(){o.sort(t),n=!0}var o=[],n=!1;return{push:function(t){o.push(t),n=!1},peek:function(t){return n||r(),void 0===t&&(t=o.length-1),o[t]},pop:function(){return n||r(),o.pop()},size:function(){return o.length},map:function(t){return o.map(t)},debug:function(){return n||r(),o}}}function o(t,r,o,n,i,e,a){var u=this;u.r1=t,u.r2=r,u.g1=o,u.g2=n,u.b1=i,u.b2=e,u.histo=a}function i(){this.vboxes=new r(function(t,r){return n.naturalOrder(t.vbox.count()*t.vbox.volume(),r.vbox.count()*r.vbox.volume())})}function e(r){var o,n,i,e,a=1<<3*h,u=new Array(a);return r.forEach(function(r){n=r[0]>>c,i=r[1]>>c,e=r[2]>>c,o=t(n,i,e),u[o]=(u[o]||0)+1}),u}function a(t,r){var n,i,e,a=1e6,u=0,s=1e6,h=0,p=1e6,f=0;return t.forEach(function(t){n=t[0]>>c,i=t[1]>>c,e=t[2]>>c,a>n?a=n:n>u&&(u=n),s>i?s=i:i>h&&(h=i),p>e?p=e:e>f&&(f=e)}),new o(a,u,s,h,p,f,r)}function u(r,o){function i(t){var r,n,i,e,a,u=t+"1",s=t+"2",c=0;for(h=o[u];h<=o[s];h++)if(v[h]>g/2){for(i=o.copy(),e=o.copy(),r=h-o[u],n=o[s]-h,a=n>=r?Math.min(o[s]-1,~~(h+n/2)):Math.max(o[u],~~(h-1-r/2));!v[a];)a++;for(c=A[a];!c&&v[a-1];)c=A[--a];return i[s]=a,e[u]=i[s]+1,[i,e]}}if(o.count()){var e=o.r2-o.r1+1,a=o.g2-o.g1+1,u=o.b2-o.b1+1,s=n.max([e,a,u]);if(1==o.count())return[o.copy()];var h,c,p,f,l,g=0,v=[],A=[];if(s==e)for(h=o.r1;h<=o.r2;h++){for(f=0,c=o.g1;c<=o.g2;c++)for(p=o.b1;p<=o.b2;p++)l=t(h,c,p),f+=r[l]||0;g+=f,v[h]=g}else if(s==a)for(h=o.g1;h<=o.g2;h++){for(f=0,c=o.r1;c<=o.r2;c++)for(p=o.b1;p<=o.b2;p++)l=t(c,h,p),f+=r[l]||0;g+=f,v[h]=g}else for(h=o.b1;h<=o.b2;h++){for(f=0,c=o.r1;c<=o.r2;c++)for(p=o.g1;p<=o.g2;p++)l=t(c,p,h),f+=r[l]||0;g+=f,v[h]=g}return v.forEach(function(t,r){A[r]=g-t}),i(s==e?"r":s==a?"g":"b")}}function s(t,o){function s(t,r){for(var o,n=1,i=0;p>i;)if(o=t.pop(),o.count()){var e=u(h,o),a=e[0],s=e[1];if(!a)return;if(t.push(a),s&&(t.push(s),n++),n>=r)return;if(i++>p)return}else t.push(o),i++}if(!t.length||2>o||o>256)return!1;var h=e(t),c=0;h.forEach(function(){c++});var l=a(t,h),g=new r(function(t,r){return n.naturalOrder(t.count(),r.count())});g.push(l),s(g,f*o);for(var v=new r(function(t,r){return n.naturalOrder(t.count()*t.volume(),r.count()*r.volume())});g.size();)v.push(g.pop());s(v,o-v.size());for(var A=new i;v.size();)A.push(v.pop());return A}var h=5,c=8-h,p=1e3,f=.75;return o.prototype={volume:function(t){var r=this;return(!r._volume||t)&&(r._volume=(r.r2-r.r1+1)*(r.g2-r.g1+1)*(r.b2-r.b1+1)),r._volume},count:function(r){var o=this,n=o.histo;if(!o._count_set||r){var i,e,a,u=0;for(i=o.r1;i<=o.r2;i++)for(e=o.g1;e<=o.g2;e++)for(a=o.b1;a<=o.b2;a++)index=t(i,e,a),u+=n[index]||0;o._count=u,o._count_set=!0}return o._count},copy:function(){var t=this;return new o(t.r1,t.r2,t.g1,t.g2,t.b1,t.b2,t.histo)},avg:function(r){var o=this,n=o.histo;if(!o._avg||r){var i,e,a,u,s,c=0,p=1<<8-h,f=0,l=0,g=0;for(e=o.r1;e<=o.r2;e++)for(a=o.g1;a<=o.g2;a++)for(u=o.b1;u<=o.b2;u++)s=t(e,a,u),i=n[s]||0,c+=i,f+=i*(e+.5)*p,l+=i*(a+.5)*p,g+=i*(u+.5)*p;o._avg=c?[~~(f/c),~~(l/c),~~(g/c)]:[~~(p*(o.r1+o.r2+1)/2),~~(p*(o.g1+o.g2+1)/2),~~(p*(o.b1+o.b2+1)/2)]}return o._avg},contains:function(t){var r=this,o=t[0]>>c;return gval=t[1]>>c,bval=t[2]>>c,o>=r.r1&&o<=r.r2&&gval>=r.g1&&gval<=r.g2&&bval>=r.b1&&bval<=r.b2}},i.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map(function(t){return t.color})},size:function(){return this.vboxes.size()},map:function(t){for(var r=this.vboxes,o=0;o<r.size();o++)if(r.peek(o).vbox.contains(t))return r.peek(o).color;return this.nearest(t)},nearest:function(t){for(var r,o,n,i=this.vboxes,e=0;e<i.size();e++)o=Math.sqrt(Math.pow(t[0]-i.peek(e).color[0],2)+Math.pow(t[1]-i.peek(e).color[1],2)+Math.pow(t[2]-i.peek(e).color[2],2)),(r>o||void 0===r)&&(r=o,n=i.peek(e).color);return n},forcebw:function(){var t=this.vboxes;t.sort(function(t,r){return n.naturalOrder(n.sum(t.color),n.sum(r.color))});var r=t[0].color;r[0]<5&&r[1]<5&&r[2]<5&&(t[0].color=[0,0,0]);var o=t.length-1,i=t[o].color;i[0]>251&&i[1]>251&&i[2]>251&&(t[o].color=[255,255,255])}},{quantize:s}}();r.exports=i.quantize},{}]},{},[3]);